import{S as re,i as oe,s as ne,k as d,q as E,a as N,e as ae,l as m,m as v,r as P,h as c,c as O,n as r,b as R,I as t,V as D,O as M,W as le,N as Q,X as ie,u as ce}from"../../../chunks/singletons-ba63ed95.js";import{g as ue,P as fe}from"../../../chunks/public-f5c80973.js";import{a as K}from"../../../chunks/js.cookie-6fa27514.js";function pe(_){let e,s,l=_[2].detail+"",o;return{c(){e=d("p"),s=E("The action was unsuccessful. "),o=E(l),this.h()},l(i){e=m(i,"P",{class:!0});var n=v(e);s=P(n,"The action was unsuccessful. "),o=P(n,l),n.forEach(c),this.h()},h(){r(e,"class","error svelte-4q3sgo")},m(i,n){R(i,e,n),t(e,s),t(e,o)},p(i,n){n&4&&l!==(l=i[2].detail+"")&&ce(o,l)},d(i){i&&c(e)}}}function de(_){let e,s;return{c(){e=d("p"),s=E("The action was successful.")},l(l){e=m(l,"P",{});var o=v(e);s=P(o,"The action was successful."),o.forEach(c)},m(l,o){R(l,e,o),t(e,s)},p:Q,d(l){l&&c(e)}}}function me(_){let e,s,l,o,i,n,p,L,b,U,k,g,f,B,S,z,F,w,T,H,W,I,X,j,q,G,Y;function Z(a,h){if(a[2].success)return de;if(a[2].detail)return pe}let A=Z(_),u=A&&A(_);return{c(){e=d("main"),s=d("form"),l=d("h1"),o=E("Login or create a new User Account"),i=N(),n=d("div"),p=d("input"),L=N(),b=d("label"),U=E("Email address"),k=N(),g=d("div"),f=d("input"),B=N(),S=d("label"),z=E("Password"),F=N(),w=d("div"),T=d("button"),H=E("Sign in"),W=N(),I=d("button"),X=E("Register"),j=N(),u&&u.c(),q=ae(),this.h()},l(a){e=m(a,"MAIN",{class:!0});var h=v(e);s=m(h,"FORM",{});var y=v(s);l=m(y,"H1",{class:!0});var $=v(l);o=P($,"Login or create a new User Account"),$.forEach(c),i=O(y),n=m(y,"DIV",{class:!0});var J=v(n);p=m(J,"INPUT",{name:!0,type:!0,class:!0,id:!0,placeholder:!0}),L=O(J),b=m(J,"LABEL",{for:!0});var x=v(b);U=P(x,"Email address"),x.forEach(c),J.forEach(c),k=O(y),g=m(y,"DIV",{class:!0});var V=v(g);f=m(V,"INPUT",{name:!0,type:!0,class:!0,id:!0,placeholder:!0}),B=O(V),S=m(V,"LABEL",{for:!0});var ee=v(S);z=P(ee,"Password"),ee.forEach(c),V.forEach(c),F=O(y),w=m(y,"DIV",{class:!0});var C=v(w);T=m(C,"BUTTON",{class:!0,type:!0});var te=v(T);H=P(te,"Sign in"),te.forEach(c),W=O(C),I=m(C,"BUTTON",{class:!0});var se=v(I);X=P(se,"Register"),se.forEach(c),C.forEach(c),y.forEach(c),h.forEach(c),j=O(a),u&&u.l(a),q=ae(),this.h()},h(){r(l,"class","h3 mb-3 fw-normal"),r(p,"name","email"),r(p,"type","email"),r(p,"class","form-control svelte-4q3sgo"),r(p,"id","floatingInput"),r(p,"placeholder","name@example.com"),r(b,"for","floatingInput"),r(n,"class","form-floating svelte-4q3sgo"),r(f,"name","password"),r(f,"type","password"),r(f,"class","form-control svelte-4q3sgo"),r(f,"id","floatingPassword"),r(f,"placeholder","Password"),r(S,"for","floatingPassword"),r(g,"class","form-floating svelte-4q3sgo"),r(T,"class","btn btn-lg btn-primary"),r(T,"type","submit"),r(I,"class","btn btn-lg btn-secondary"),r(w,"class","d-grid gap-2"),r(e,"class","form-signin w-100 m-auto svelte-4q3sgo")},m(a,h){R(a,e,h),t(e,s),t(s,l),t(l,o),t(s,i),t(s,n),t(n,p),D(p,_[0]),t(n,L),t(n,b),t(b,U),t(s,k),t(s,g),t(g,f),D(f,_[1]),t(g,B),t(g,S),t(S,z),t(s,F),t(s,w),t(w,T),t(T,H),t(w,W),t(w,I),t(I,X),R(a,j,h),u&&u.m(a,h),R(a,q,h),G||(Y=[M(p,"input",_[5]),M(f,"input",_[6]),M(I,"click",le(_[4])),M(s,"submit",le(_[3]))],G=!0)},p(a,[h]){h&1&&p.value!==a[0]&&D(p,a[0]),h&2&&f.value!==a[1]&&D(f,a[1]),A===(A=Z(a))&&u?u.p(a,h):(u&&u.d(1),u=A&&A(a),u&&(u.c(),u.m(q.parentNode,q)))},i:Q,o:Q,d(a){a&&c(e),a&&c(j),u&&u.d(a),a&&c(q),G=!1,ie(Y)}}}function _e(_,e,s){let l=fe,o,i,n={};async function p(){const k=await fetch(l+"token/",{method:"POST",body:"grant_type=password&username="+o+"&password="+i,headers:{"Content-Type":"application/x-www-form-urlencoded"}});let g=await k.json();s(2,n={success:k.ok,detail:JSON.stringify(g)}),k.ok&&K.set("jwt",g.access_token,{path:"/",sameSite:"strict"});const f=await fetch(l+"users/me",{headers:{Authorization:"Bearer "+K.get("jwt")}});let B=await f.json();f.ok&&K.set("user",JSON.stringify(B),{path:"/",sameSite:"strict"}),await ue("/",{invalidateAll:!0})}function L(){console.log("register",o,i)}function b(){o=this.value,s(0,o)}function U(){i=this.value,s(1,i)}return[o,i,n,p,L,b,U]}class be extends re{constructor(e){super(),oe(this,e,_e,me,ne,{})}}export{be as default};
