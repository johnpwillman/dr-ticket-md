import{S as re,i as ne,s as ie,k as m,q as w,a as S,e as se,l as _,m as g,r as y,h as c,c as I,n,b as j,I as a,V as D,O as M,W as ae,N as le,X as ce,u as oe}from"../../../chunks/singletons-4ead38d5.js";import{g as ue,P as fe}from"../../../chunks/public-9885d377.js";import{a as K}from"../../../chunks/js.cookie-6fa27514.js";function pe(p){let t,l,r=p[2].detail+"",i;return{c(){t=m("p"),l=w("The action was unsuccessful. "),i=w(r),this.h()},l(s){t=_(s,"P",{class:!0});var e=g(t);l=y(e,"The action was unsuccessful. "),i=y(e,r),e.forEach(c),this.h()},h(){n(t,"class","error svelte-4q3sgo")},m(s,e){j(s,t,e),a(t,l),a(t,i)},p(s,e){e&4&&r!==(r=s[2].detail+"")&&oe(i,r)},d(s){s&&c(t)}}}function de(p){let t,l,r=p[2].detail+"",i;return{c(){t=m("p"),l=w("The action was successful. "),i=w(r)},l(s){t=_(s,"P",{});var e=g(t);l=y(e,"The action was successful. "),i=y(e,r),e.forEach(c)},m(s,e){j(s,t,e),a(t,l),a(t,i)},p(s,e){e&4&&r!==(r=s[2].detail+"")&&oe(i,r)},d(s){s&&c(t)}}}function me(p){let t,l,r,i,s,e,d,J,E,L,b,h,f,U,N,z,F,P,T,H,W,O,X,B,q,G,Q;function Y(o,v){if(o[2].success)return de;if(o[2].detail)return pe}let A=Y(p),u=A&&A(p);return{c(){t=m("main"),l=m("form"),r=m("h1"),i=w("Login or create a new User Account"),s=S(),e=m("div"),d=m("input"),J=S(),E=m("label"),L=w("Email address"),b=S(),h=m("div"),f=m("input"),U=S(),N=m("label"),z=w("Password"),F=S(),P=m("div"),T=m("button"),H=w("Sign in"),W=S(),O=m("button"),X=w("Register"),B=S(),u&&u.c(),q=se(),this.h()},l(o){t=_(o,"MAIN",{class:!0});var v=g(t);l=_(v,"FORM",{});var k=g(l);r=_(k,"H1",{class:!0});var Z=g(r);i=y(Z,"Login or create a new User Account"),Z.forEach(c),s=I(k),e=_(k,"DIV",{class:!0});var R=g(e);d=_(R,"INPUT",{name:!0,type:!0,class:!0,id:!0,placeholder:!0}),J=I(R),E=_(R,"LABEL",{for:!0});var $=g(E);L=y($,"Email address"),$.forEach(c),R.forEach(c),b=I(k),h=_(k,"DIV",{class:!0});var C=g(h);f=_(C,"INPUT",{name:!0,type:!0,class:!0,id:!0,placeholder:!0}),U=I(C),N=_(C,"LABEL",{for:!0});var x=g(N);z=y(x,"Password"),x.forEach(c),C.forEach(c),F=I(k),P=_(k,"DIV",{class:!0});var V=g(P);T=_(V,"BUTTON",{class:!0,type:!0});var ee=g(T);H=y(ee,"Sign in"),ee.forEach(c),W=I(V),O=_(V,"BUTTON",{class:!0});var te=g(O);X=y(te,"Register"),te.forEach(c),V.forEach(c),k.forEach(c),v.forEach(c),B=I(o),u&&u.l(o),q=se(),this.h()},h(){n(r,"class","h3 mb-3 fw-normal"),n(d,"name","email"),n(d,"type","email"),n(d,"class","form-control svelte-4q3sgo"),n(d,"id","floatingInput"),n(d,"placeholder","name@example.com"),n(E,"for","floatingInput"),n(e,"class","form-floating svelte-4q3sgo"),n(f,"name","password"),n(f,"type","password"),n(f,"class","form-control svelte-4q3sgo"),n(f,"id","floatingPassword"),n(f,"placeholder","Password"),n(N,"for","floatingPassword"),n(h,"class","form-floating svelte-4q3sgo"),n(T,"class","btn btn-lg btn-primary"),n(T,"type","submit"),n(O,"class","btn btn-lg btn-secondary"),n(P,"class","d-grid gap-2"),n(t,"class","form-signin w-100 m-auto svelte-4q3sgo")},m(o,v){j(o,t,v),a(t,l),a(l,r),a(r,i),a(l,s),a(l,e),a(e,d),D(d,p[0]),a(e,J),a(e,E),a(E,L),a(l,b),a(l,h),a(h,f),D(f,p[1]),a(h,U),a(h,N),a(N,z),a(l,F),a(l,P),a(P,T),a(T,H),a(P,W),a(P,O),a(O,X),j(o,B,v),u&&u.m(o,v),j(o,q,v),G||(Q=[M(d,"input",p[5]),M(f,"input",p[6]),M(O,"click",ae(p[4])),M(l,"submit",ae(p[3]))],G=!0)},p(o,[v]){v&1&&d.value!==o[0]&&D(d,o[0]),v&2&&f.value!==o[1]&&D(f,o[1]),A===(A=Y(o))&&u?u.p(o,v):(u&&u.d(1),u=A&&A(o),u&&(u.c(),u.m(q.parentNode,q)))},i:le,o:le,d(o){o&&c(t),o&&c(B),u&&u.d(o),o&&c(q),G=!1,ce(Q)}}}function _e(p,t,l){let r=fe,i,s,e={};async function d(){const b=await fetch(r+"token/",{method:"POST",body:"grant_type=password&username="+i+"&password="+s,headers:{"Content-Type":"application/x-www-form-urlencoded"}});let h=await b.json();l(2,e={success:b.ok,detail:JSON.stringify(h)}),b.ok&&K.set("jwt",h.access_token,{path:"/",sameSite:"strict"});const f=await fetch(r+"users/me",{headers:{Authorization:"Bearer "+K.get("jwt")}});let U=await f.json();f.ok&&(K.set("user",JSON.stringify(U),{path:"/",sameSite:"strict"}),await ue("/"))}async function J(){console.log("register",i,s);const b=await fetch(r+"users/",{method:"POST",body:JSON.stringify({email:i,password:s}),headers:{"Content-Type":"application/json"}});let h=await b.json();l(2,e={success:b.ok,detail:b.ok?"Please login.":JSON.stringify(h)})}function E(){i=this.value,l(0,i)}function L(){s=this.value,l(1,s)}return[i,s,e,d,J,E,L]}class be extends re{constructor(t){super(),ne(this,t,_e,me,ie,{})}}export{be as default};
