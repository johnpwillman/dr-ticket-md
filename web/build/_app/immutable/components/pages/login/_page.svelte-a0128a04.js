import{S as le,i as oe,s as re,k as m,q as b,a as S,l as h,m as g,r as y,h as f,c as I,n as r,b as G,I as s,V as R,O as C,W as te,N as se,X as ne,u as ae}from"../../../chunks/singletons-51fc219c.js";import{g as ie}from"../../../chunks/navigation-8de0419e.js";import{a as X,P as ce}from"../../../chunks/public-9d42eb47.js";function ue(p){let e,l,o=p[2].detail+"",n;return{c(){e=m("p"),l=b("The action was unsuccessful. "),n=b(o),this.h()},l(a){e=h(a,"P",{class:!0});var t=g(e);l=y(t,"The action was unsuccessful. "),n=y(t,o),t.forEach(f),this.h()},h(){r(e,"class","error svelte-4q3sgo")},m(a,t){G(a,e,t),s(e,l),s(e,n)},p(a,t){t&4&&o!==(o=a[2].detail+"")&&ae(n,o)},d(a){a&&f(e)}}}function fe(p){let e,l,o=p[2].detail+"",n;return{c(){e=m("p"),l=b("The action was successful. "),n=b(o)},l(a){e=h(a,"P",{});var t=g(e);l=y(t,"The action was successful. "),n=y(t,o),t.forEach(f)},m(a,t){G(a,e,t),s(e,l),s(e,n)},p(a,t){t&4&&o!==(o=a[2].detail+"")&&ae(n,o)},d(a){a&&f(e)}}}function pe(p){let e,l,o,n,a,t,d,A,E,J,v,_,u,L,N,V,D,P,k,M,z,O,F,H,W,K;function Q(c,w){if(c[2].success)return fe;if(c[2].detail)return ue}let q=Q(p),i=q&&q(p);return{c(){e=m("main"),l=m("form"),o=m("h1"),n=b("Login or create a new User Account"),a=S(),t=m("div"),d=m("input"),A=S(),E=m("label"),J=b("Email address"),v=S(),_=m("div"),u=m("input"),L=S(),N=m("label"),V=b("Password"),D=S(),P=m("div"),k=m("button"),M=b("Sign in"),z=S(),O=m("button"),F=b("Register"),H=S(),i&&i.c(),this.h()},l(c){e=h(c,"MAIN",{class:!0});var w=g(e);l=h(w,"FORM",{});var T=g(l);o=h(T,"H1",{class:!0});var Y=g(o);n=y(Y,"Login or create a new User Account"),Y.forEach(f),a=I(T),t=h(T,"DIV",{class:!0});var U=g(t);d=h(U,"INPUT",{name:!0,type:!0,class:!0,id:!0,placeholder:!0}),A=I(U),E=h(U,"LABEL",{for:!0});var Z=g(E);J=y(Z,"Email address"),Z.forEach(f),U.forEach(f),v=I(T),_=h(T,"DIV",{class:!0});var j=g(_);u=h(j,"INPUT",{name:!0,type:!0,class:!0,id:!0,placeholder:!0}),L=I(j),N=h(j,"LABEL",{for:!0});var $=g(N);V=y($,"Password"),$.forEach(f),j.forEach(f),D=I(T),P=h(T,"DIV",{class:!0});var B=g(P);k=h(B,"BUTTON",{class:!0,type:!0});var x=g(k);M=y(x,"Sign in"),x.forEach(f),z=I(B),O=h(B,"BUTTON",{class:!0});var ee=g(O);F=y(ee,"Register"),ee.forEach(f),B.forEach(f),T.forEach(f),H=I(w),i&&i.l(w),w.forEach(f),this.h()},h(){r(o,"class","h3 mb-3 fw-normal"),r(d,"name","email"),r(d,"type","email"),r(d,"class","form-control svelte-4q3sgo"),r(d,"id","floatingInput"),r(d,"placeholder","name@example.com"),r(E,"for","floatingInput"),r(t,"class","form-floating svelte-4q3sgo"),r(u,"name","password"),r(u,"type","password"),r(u,"class","form-control svelte-4q3sgo"),r(u,"id","floatingPassword"),r(u,"placeholder","Password"),r(N,"for","floatingPassword"),r(_,"class","form-floating svelte-4q3sgo"),r(k,"class","btn btn-lg btn-primary"),r(k,"type","submit"),r(O,"class","btn btn-lg btn-secondary"),r(P,"class","d-grid gap-2"),r(e,"class","form-signin w-100 m-auto svelte-4q3sgo")},m(c,w){G(c,e,w),s(e,l),s(l,o),s(o,n),s(l,a),s(l,t),s(t,d),R(d,p[0]),s(t,A),s(t,E),s(E,J),s(l,v),s(l,_),s(_,u),R(u,p[1]),s(_,L),s(_,N),s(N,V),s(l,D),s(l,P),s(P,k),s(k,M),s(P,z),s(P,O),s(O,F),s(e,H),i&&i.m(e,null),W||(K=[C(d,"input",p[5]),C(u,"input",p[6]),C(O,"click",te(p[4])),C(l,"submit",te(p[3]))],W=!0)},p(c,[w]){w&1&&d.value!==c[0]&&R(d,c[0]),w&2&&u.value!==c[1]&&R(u,c[1]),q===(q=Q(c))&&i?i.p(c,w):(i&&i.d(1),i=q&&q(c),i&&(i.c(),i.m(e,null)))},i:se,o:se,d(c){c&&f(e),i&&i.d(),W=!1,ne(K)}}}function de(p,e,l){let o=ce,n,a,t={};async function d(){const v=await fetch(o+"token/",{method:"POST",body:"grant_type=password&username="+n+"&password="+a,headers:{"Content-Type":"application/x-www-form-urlencoded"}});let _=await v.json();l(2,t={success:v.ok,detail:JSON.stringify(_)}),v.ok&&X.set("jwt",_.access_token,{path:"/",sameSite:"strict"});const u=await fetch(o+"users/me",{headers:{Authorization:"Bearer "+X.get("jwt")}});let L=await u.json();u.ok&&(X.set("user",JSON.stringify(L),{path:"/",sameSite:"strict"}),await ie("/"))}async function A(){console.log("register",n,a);const v=await fetch(o+"users/",{method:"POST",body:JSON.stringify({email:n,password:a}),headers:{"Content-Type":"application/json"}});let _=await v.json();l(2,t={success:v.ok,detail:v.ok?"Please login.":JSON.stringify(_)})}function E(){n=this.value,l(0,n)}function J(){a=this.value,l(1,a)}return[n,a,t,d,A,E,J]}class ge extends le{constructor(e){super(),oe(this,e,de,pe,re,{})}}export{ge as default};
