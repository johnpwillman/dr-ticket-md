import{S as Z,i as $,s as x,P as ee,k as d,l as p,m as _,h as c,n as h,b as H,Q as te,N as z,q as U,r as j,I as l,a as N,c as O,T as ae,O as V,W as se,u as le,X as ne}from"../../../chunks/singletons-da006040.js";import{g as M,P as re}from"../../../chunks/public-c30dc17b.js";import{a as C}from"../../../chunks/js.cookie-6fa27514.js";function G(n,e,a){const t=n.slice();return t[7]=e[a],t[8]=e,t[9]=a,t}function ce(n){let e,a=n[10]+"",t;return{c(){e=d("p"),t=U(a)},l(s){e=p(s,"P",{});var k=_(e);t=j(k,a),k.forEach(c)},m(s,k){H(s,e,k),l(e,t)},p:z,d(s){s&&c(e)}}}function oe(n){let e,a,t,s,k,y,v,b,I,i,m,E,g,B,D,A=n[0],r=[];for(let u=0;u<A.length;u+=1)r[u]=K(G(n,A,u));return{c(){e=d("table"),a=d("thead"),t=d("tr"),s=d("th"),k=U("Email"),y=N(),v=d("th"),b=U("Admin"),I=N(),i=d("th"),m=U("Disabled"),E=N(),g=d("th"),B=N(),D=d("tbody");for(let u=0;u<r.length;u+=1)r[u].c();this.h()},l(u){e=p(u,"TABLE",{class:!0});var w=_(e);a=p(w,"THEAD",{});var o=_(a);t=p(o,"TR",{});var T=_(t);s=p(T,"TH",{class:!0});var R=_(s);k=j(R,"Email"),R.forEach(c),y=O(T),v=p(T,"TH",{class:!0});var S=_(v);b=j(S,"Admin"),S.forEach(c),I=O(T),i=p(T,"TH",{class:!0});var q=_(i);m=j(q,"Disabled"),q.forEach(c),E=O(T),g=p(T,"TH",{class:!0}),_(g).forEach(c),T.forEach(c),o.forEach(c),B=O(w),D=p(w,"TBODY",{});var P=_(D);for(let f=0;f<r.length;f+=1)r[f].l(P);P.forEach(c),w.forEach(c),this.h()},h(){h(s,"class","svelte-1pup5v5"),h(v,"class","svelte-1pup5v5"),h(i,"class","svelte-1pup5v5"),h(g,"class","svelte-1pup5v5"),h(e,"class","mx-auto user-table svelte-1pup5v5")},m(u,w){H(u,e,w),l(e,a),l(a,t),l(t,s),l(s,k),l(t,y),l(t,v),l(v,b),l(t,I),l(t,i),l(i,m),l(t,E),l(t,g),l(e,B),l(e,D);for(let o=0;o<r.length;o+=1)r[o].m(D,null)},p(u,w){if(w&5){A=u[0];let o;for(o=0;o<A.length;o+=1){const T=G(u,A,o);r[o]?r[o].p(T,w):(r[o]=K(T),r[o].c(),r[o].m(D,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=A.length}},d(u){u&&c(e),ae(r,u)}}}function K(n){let e,a,t=n[7].email+"",s,k,y,v,b,I,i,m,E,g,B,D,A,r,u,w,o,T;function R(){n[3].call(b,n[8],n[9])}function S(){n[4].call(g,n[8],n[9])}function q(){return n[5](n[7])}return{c(){e=d("tr"),a=d("td"),s=U(t),k=N(),y=d("td"),v=d("div"),b=d("input"),I=U(`\r
                        Admin`),i=N(),m=d("td"),E=d("div"),g=d("input"),B=U(`\r
                        Disabled`),D=N(),A=d("td"),r=d("button"),u=U("Update"),w=N(),this.h()},l(P){e=p(P,"TR",{});var f=_(e);a=p(f,"TD",{class:!0});var Q=_(a);s=j(Q,t),Q.forEach(c),k=O(f),y=p(f,"TD",{class:!0});var W=_(y);v=p(W,"DIV",{class:!0});var J=_(v);b=p(J,"INPUT",{class:!0,type:!0,name:!0}),I=j(J,`\r
                        Admin`),J.forEach(c),W.forEach(c),i=O(f),m=p(f,"TD",{class:!0});var X=_(m);E=p(X,"DIV",{class:!0});var L=_(E);g=p(L,"INPUT",{class:!0,type:!0,name:!0}),B=j(L,`\r
                        Disabled`),L.forEach(c),X.forEach(c),D=O(f),A=p(f,"TD",{class:!0});var Y=_(A);r=p(Y,"BUTTON",{class:!0,type:!0,name:!0});var F=_(r);u=j(F,"Update"),F.forEach(c),Y.forEach(c),w=O(f),f.forEach(c),this.h()},h(){h(a,"class","svelte-1pup5v5"),h(b,"class","form-check-input"),h(b,"type","checkbox"),h(b,"name","admin"),h(v,"class","form-check"),h(y,"class","text-center svelte-1pup5v5"),h(g,"class","form-check-input"),h(g,"type","checkbox"),h(g,"name","disabled"),h(E,"class","form-check"),h(m,"class","text-center svelte-1pup5v5"),h(r,"class","btn btn-secondary btn-sm bg-indigo-400 svelte-1pup5v5"),h(r,"type","submit"),h(r,"name","submit"),h(A,"class","text-center svelte-1pup5v5")},m(P,f){H(P,e,f),l(e,a),l(a,s),l(e,k),l(e,y),l(y,v),l(v,b),b.checked=n[7].admin,l(v,I),l(e,i),l(e,m),l(m,E),l(E,g),g.checked=n[7].disabled,l(E,B),l(e,D),l(e,A),l(A,r),l(r,u),l(e,w),o||(T=[V(b,"change",R),V(g,"change",S),V(r,"click",se(q))],o=!0)},p(P,f){n=P,f&1&&t!==(t=n[7].email+"")&&le(s,t),f&1&&(b.checked=n[7].admin),f&1&&(g.checked=n[7].disabled)},d(P){P&&c(e),o=!1,ne(T)}}}function ie(n){let e,a;return{c(){e=d("p"),a=U("Retrieving users")},l(t){e=p(t,"P",{});var s=_(e);a=j(s,"Retrieving users"),s.forEach(c)},m(t,s){H(t,e,s),l(e,a)},p:z,d(t){t&&c(e)}}}function ue(n){let e,a={ctx:n,current:null,token:null,hasCatch:!0,pending:ie,then:oe,catch:ce,error:10};return ee(n[1](),a),{c(){e=d("main"),a.block.c(),this.h()},l(t){e=p(t,"MAIN",{class:!0});var s=_(e);a.block.l(s),s.forEach(c),this.h()},h(){h(e,"class","container svelte-1pup5v5")},m(t,s){H(t,e,s),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=null},p(t,[s]){n=t,te(a,n,s)},i:z,o:z,d(t){t&&c(e),a.block.d(),a.token=null,a=null}}}function he(n,e,a){let t=re,s;async function k(){let i=C.get("user"),m=i?JSON.parse(i):void 0;if((!m||!m.admin)&&await M("/login"),C.get("jwt")){const E=await fetch(t+"users/",{headers:{Authorization:"Bearer "+C.get("jwt"),"Content-Type":"application/json"}});E.status===401&&(C.remove("jwt"),C.remove("user"),await M("/login",{invalidateAll:!0})),a(0,s=await E.json())}}async function y(i){confirm("Update user?")==!0&&(await fetch(t+"users/"+i.key,{method:"PATCH",body:JSON.stringify(i),headers:{Authorization:"Bearer "+C.get("jwt"),"Content-Type":"application/json"}})).status===401&&(C.remove("jwt"),C.remove("user"),await M("/login",{invalidateAll:!0}))}function v(i,m){i[m].admin=this.checked,a(0,s)}function b(i,m){i[m].disabled=this.checked,a(0,s)}return[s,k,y,v,b,i=>y(i)]}class _e extends Z{constructor(e){super(),$(this,e,he,ue,x,{})}}export{_e as default};
