import{S as K,i as Z,s as x,P as ee,k as d,l as h,m as f,h as c,n as u,b as R,Q as te,N as z,q as j,r as I,I as l,a as O,c as B,T as ae,O as Y,W as se,u as le,X as ne}from"../../../chunks/singletons-b1eee4c7.js";import{g as V,P as re}from"../../../chunks/public-3686098f.js";import{a as N}from"../../../chunks/js.cookie-6fa27514.js";function F(r,e,a){const t=r.slice();return t[6]=e[a],t[7]=e,t[8]=a,t}function ce(r){let e,a=r[9]+"",t;return{c(){e=d("p"),t=j(a)},l(s){e=h(s,"P",{});var k=f(e);t=I(k,a),k.forEach(c)},m(s,k){R(s,e,k),l(e,t)},p:z,d(s){s&&c(e)}}}function oe(r){let e,a,t,s,k,T,m,b,_,v,y,w,E,C,D,P=r[0],o=[];for(let n=0;n<P.length;n+=1)o[n]=G(F(r,P,n));return{c(){e=d("table"),a=d("thead"),t=d("tr"),s=d("th"),k=j("Email"),T=O(),m=d("th"),b=j("Admin"),_=O(),v=d("th"),y=j("Disabled"),w=O(),E=d("th"),C=O(),D=d("tbody");for(let n=0;n<o.length;n+=1)o[n].c();this.h()},l(n){e=h(n,"TABLE",{class:!0});var A=f(e);a=h(A,"THEAD",{});var i=f(a);t=h(i,"TR",{});var g=f(t);s=h(g,"TH",{class:!0});var H=f(s);k=I(H,"Email"),H.forEach(c),T=B(g),m=h(g,"TH",{class:!0});var S=f(m);b=I(S,"Admin"),S.forEach(c),_=B(g),v=h(g,"TH",{class:!0});var q=f(v);y=I(q,"Disabled"),q.forEach(c),w=B(g),E=h(g,"TH",{class:!0}),f(E).forEach(c),g.forEach(c),i.forEach(c),C=B(A),D=h(A,"TBODY",{});var U=f(D);for(let p=0;p<o.length;p+=1)o[p].l(U);U.forEach(c),A.forEach(c),this.h()},h(){u(s,"class","svelte-1pup5v5"),u(m,"class","svelte-1pup5v5"),u(v,"class","svelte-1pup5v5"),u(E,"class","svelte-1pup5v5"),u(e,"class","mx-auto user-table svelte-1pup5v5")},m(n,A){R(n,e,A),l(e,a),l(a,t),l(t,s),l(s,k),l(t,T),l(t,m),l(m,b),l(t,_),l(t,v),l(v,y),l(t,w),l(t,E),l(e,C),l(e,D);for(let i=0;i<o.length;i+=1)o[i].m(D,null)},p(n,A){if(A&5){P=n[0];let i;for(i=0;i<P.length;i+=1){const g=F(n,P,i);o[i]?o[i].p(g,A):(o[i]=G(g),o[i].c(),o[i].m(D,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=P.length}},d(n){n&&c(e),ae(o,n)}}}function G(r){let e,a,t=r[6].email+"",s,k,T,m,b,_,v,y,w,E,C,D,P,o,n,A,i,g,H;function S(){r[3].call(b,r[7],r[8])}function q(){return r[4](r[6])}return{c(){e=d("tr"),a=d("td"),s=j(t),k=O(),T=d("td"),m=d("div"),b=d("input"),_=j(`\r
                        Admin`),v=O(),y=d("td"),w=d("div"),E=d("input"),D=j(`\r
                        Disabled`),P=O(),o=d("td"),n=d("button"),A=j("Update"),i=O(),this.h()},l(U){e=h(U,"TR",{});var p=f(e);a=h(p,"TD",{class:!0});var $=f(a);s=I($,t),$.forEach(c),k=B(p),T=h(p,"TD",{class:!0});var M=f(T);m=h(M,"DIV",{class:!0});var J=f(m);b=h(J,"INPUT",{class:!0,type:!0,name:!0}),_=I(J,`\r
                        Admin`),J.forEach(c),M.forEach(c),v=B(p),y=h(p,"TD",{class:!0});var Q=f(y);w=h(Q,"DIV",{class:!0});var L=f(w);E=h(L,"INPUT",{class:!0,type:!0,name:!0}),D=I(L,`\r
                        Disabled`),L.forEach(c),Q.forEach(c),P=B(p),o=h(p,"TD",{class:!0});var W=f(o);n=h(W,"BUTTON",{class:!0,type:!0,name:!0});var X=f(n);A=I(X,"Update"),X.forEach(c),W.forEach(c),i=B(p),p.forEach(c),this.h()},h(){u(a,"class","svelte-1pup5v5"),u(b,"class","form-check-input"),u(b,"type","checkbox"),u(b,"name","admin"),u(m,"class","form-check"),u(T,"class","text-center svelte-1pup5v5"),u(E,"class","form-check-input"),u(E,"type","checkbox"),u(E,"name","disabled"),E.checked=C=r[6].disabled,u(w,"class","form-check"),u(y,"class","text-center svelte-1pup5v5"),u(n,"class","btn btn-secondary btn-sm bg-indigo-400 svelte-1pup5v5"),u(n,"type","submit"),u(n,"name","submit"),u(o,"class","text-center svelte-1pup5v5")},m(U,p){R(U,e,p),l(e,a),l(a,s),l(e,k),l(e,T),l(T,m),l(m,b),b.checked=r[6].admin,l(m,_),l(e,v),l(e,y),l(y,w),l(w,E),l(w,D),l(e,P),l(e,o),l(o,n),l(n,A),l(e,i),g||(H=[Y(b,"change",S),Y(n,"click",se(q))],g=!0)},p(U,p){r=U,p&1&&t!==(t=r[6].email+"")&&le(s,t),p&1&&(b.checked=r[6].admin),p&1&&C!==(C=r[6].disabled)&&(E.checked=C)},d(U){U&&c(e),g=!1,ne(H)}}}function ie(r){let e,a;return{c(){e=d("p"),a=j("Retrieving users")},l(t){e=h(t,"P",{});var s=f(e);a=I(s,"Retrieving users"),s.forEach(c)},m(t,s){R(t,e,s),l(e,a)},p:z,d(t){t&&c(e)}}}function ue(r){let e,a={ctx:r,current:null,token:null,hasCatch:!0,pending:ie,then:oe,catch:ce,error:9};return ee(r[1](),a),{c(){e=d("main"),a.block.c(),this.h()},l(t){e=h(t,"MAIN",{class:!0});var s=f(e);a.block.l(s),s.forEach(c),this.h()},h(){u(e,"class","container svelte-1pup5v5")},m(t,s){R(t,e,s),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=null},p(t,[s]){r=t,te(a,r,s)},i:z,o:z,d(t){t&&c(e),a.block.d(),a.token=null,a=null}}}function de(r,e,a){let t=re,s;async function k(){let _=N.get("user"),v=_?JSON.parse(_):void 0;if((!v||!v.admin)&&await V("/login"),N.get("jwt")){const y=await fetch(t+"users/",{headers:{Authorization:"Bearer "+N.get("jwt"),"Content-Type":"application/json"}});y.status===401&&(N.remove("jwt"),N.remove("user"),await V("/login",{invalidateAll:!0})),a(0,s=await y.json())}}async function T(_){confirm("Update user?")==!0&&(await fetch(t+"users/"+_.key,{method:"PATCH",body:JSON.stringify(_),headers:{Authorization:"Bearer "+N.get("jwt"),"Content-Type":"application/json"}})).status===401&&(N.remove("jwt"),N.remove("user"),await V("/login",{invalidateAll:!0}))}function m(_,v){_[v].admin=this.checked,a(0,s)}return[s,k,T,m,_=>T(_)]}class _e extends K{constructor(e){super(),Z(this,e,de,ue,x,{})}}export{_e as default};
