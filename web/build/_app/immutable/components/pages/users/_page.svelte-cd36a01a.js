import{S as ee,i as te,s as ae,P as se,k as m,l as v,m as y,h as c,n as w,b as I,Q as le,N as O,q as N,r as T,I as h,a as D,e as F,c as P,V as G,O as q,T as ne,W as K,u as B,X as ie}from"../../../chunks/singletons-7ab629c5.js";import{g as H}from"../../../chunks/navigation-ae3039f1.js";import{a as A,P as oe}from"../../../chunks/public-9d42eb47.js";function Y(s,e,a){const n=s.slice();return n[11]=e[a],n}function re(s){let e,a=s[14]+"",n;return{c(){e=m("p"),n=N(a)},l(i){e=v(i,"P",{});var o=y(e);n=T(o,a),o.forEach(c)},m(i,o){I(i,e,o),h(e,n)},p:O,d(i){i&&c(e)}}}function ce(s){let e,a,n,i,o,b,f,g,p,_=s[1],r=[];for(let l=0;l<_.length;l+=1)r[l]=Z(Y(s,_,l));return{c(){e=m("div"),a=m("h1"),n=N("Registered Users"),i=D(),o=m("input"),b=D();for(let l=0;l<r.length;l+=1)r[l].c();f=F(),this.h()},l(l){e=v(l,"DIV",{class:!0});var d=y(e);a=v(d,"H1",{});var t=y(a);n=T(t,"Registered Users"),t.forEach(c),i=P(d),o=v(d,"INPUT",{class:!0,placeholder:!0}),d.forEach(c),b=P(l);for(let u=0;u<r.length;u+=1)r[u].l(l);f=F(),this.h()},h(){w(o,"class","form-control"),w(o,"placeholder","Search by email"),w(e,"class","row pb-3")},m(l,d){I(l,e,d),h(e,a),h(a,n),h(e,i),h(e,o),G(o,s[0]),I(l,b,d);for(let t=0;t<r.length;t+=1)r[t].m(l,d);I(l,f,d),g||(p=q(o,"input",s[6]),g=!0)},p(l,d){if(d&1&&o.value!==l[0]&&G(o,l[0]),d&26){_=l[1];let t;for(t=0;t<_.length;t+=1){const u=Y(l,_,t);r[t]?r[t].p(u,d):(r[t]=Z(u),r[t].c(),r[t].m(f.parentNode,f))}for(;t<r.length;t+=1)r[t].d(1);r.length=_.length}},d(l){l&&c(e),l&&c(b),ne(r,l),l&&c(f),g=!1,p()}}}function Z(s){let e,a,n,i=s[11].email+"",o,b,f,g,p,_=s[11].admin?"Admin":"Not Admin",r,l,d,t,u,E=s[11].disabled?"Disabled":"Enabled",S,j,V,R,z;function $(){return s[7](s[11])}function x(){return s[8](s[11])}return{c(){e=m("div"),a=m("div"),n=m("h5"),o=N(i),b=D(),f=m("div"),g=m("div"),p=m("button"),r=N(_),d=D(),t=m("div"),u=m("button"),S=N(E),V=D(),this.h()},l(U){e=v(U,"DIV",{class:!0});var k=y(e);a=v(k,"DIV",{class:!0});var J=y(a);n=v(J,"H5",{});var L=y(n);o=T(L,i),L.forEach(c),J.forEach(c),b=P(k),f=v(k,"DIV",{class:!0});var C=y(f);g=v(C,"DIV",{class:!0});var M=y(g);p=v(M,"BUTTON",{class:!0});var Q=y(p);r=T(Q,_),Q.forEach(c),M.forEach(c),d=P(C),t=v(C,"DIV",{class:!0});var W=y(t);u=v(W,"BUTTON",{class:!0});var X=y(u);S=T(X,E),X.forEach(c),W.forEach(c),C.forEach(c),V=P(k),k.forEach(c),this.h()},h(){w(a,"class","flex-grow-1 col-sm-6 text-start"),w(p,"class",l="btn btn-secondary checked-"+s[11].admin.toString()+" svelte-1kcwgo7"),w(g,"class","ms-auto pe-2"),w(u,"class",j="btn btn-secondary checked-"+(!s[11].disabled).toString()+" svelte-1kcwgo7"),w(t,"class","me-auto ps-2"),w(f,"class","col-sm-6 d-flex align-items-center"),w(e,"class","row d-flex flex-wrap pb-3")},m(U,k){I(U,e,k),h(e,a),h(a,n),h(n,o),h(e,b),h(e,f),h(f,g),h(g,p),h(p,r),h(f,d),h(f,t),h(t,u),h(u,S),h(e,V),R||(z=[q(p,"click",K($)),q(u,"click",K(x))],R=!0)},p(U,k){s=U,k&2&&i!==(i=s[11].email+"")&&B(o,i),k&2&&_!==(_=s[11].admin?"Admin":"Not Admin")&&B(r,_),k&2&&l!==(l="btn btn-secondary checked-"+s[11].admin.toString()+" svelte-1kcwgo7")&&w(p,"class",l),k&2&&E!==(E=s[11].disabled?"Disabled":"Enabled")&&B(S,E),k&2&&j!==(j="btn btn-secondary checked-"+(!s[11].disabled).toString()+" svelte-1kcwgo7")&&w(u,"class",j)},d(U){U&&c(e),R=!1,ie(z)}}}function de(s){let e,a;return{c(){e=m("p"),a=N("Retrieving users")},l(n){e=v(n,"P",{});var i=y(e);a=T(i,"Retrieving users"),i.forEach(c)},m(n,i){I(n,e,i),h(e,a)},p:O,d(n){n&&c(e)}}}function ue(s){let e,a={ctx:s,current:null,token:null,hasCatch:!0,pending:de,then:ce,catch:re,error:14};return se(s[2](),a),{c(){e=m("main"),a.block.c(),this.h()},l(n){e=v(n,"MAIN",{class:!0});var i=y(e);a.block.l(i),i.forEach(c),this.h()},h(){w(e,"class","container text-center mx-auto svelte-1kcwgo7")},m(n,i){I(n,e,i),a.block.m(e,a.anchor=null),a.mount=()=>e,a.anchor=null},p(n,[i]){s=n,le(a,s,i)},i:O,o:O,d(n){n&&c(e),a.block.d(),a.token=null,a=null}}}function he(s,e,a){let n,i=oe,o=[],b="";async function f(){let t=A.get("user"),u=t?JSON.parse(t):void 0;if((!u||!u.admin)&&await H("/login"),A.get("jwt")){const E=await fetch(i+"users/",{headers:{Authorization:"Bearer "+A.get("jwt"),"Content-Type":"application/json"}});E.status===401&&(A.remove("jwt"),A.remove("user"),await H("/login",{invalidateAll:!0})),a(5,o=await E.json())}}async function g(t){confirm("Update user?")==!0&&((await fetch(i+"users/"+t.key,{method:"PATCH",body:JSON.stringify(t),headers:{Authorization:"Bearer "+A.get("jwt"),"Content-Type":"application/json"}})).status===401&&(A.remove("jwt"),A.remove("user"),await H("/login",{invalidateAll:!0})),await f())}async function p(t){t.admin=!t.admin,await g(t)}async function _(t){t.disabled=!t.disabled,await g(t)}function r(){b=this.value,a(0,b)}const l=t=>p(t),d=t=>_(t);return s.$$.update=()=>{s.$$.dirty&33&&a(1,n=o.filter(t=>t.email.includes(b)))},[b,n,f,p,_,o,r,l,d]}class me extends ee{constructor(e){super(),te(this,e,he,ue,ae,{})}}export{me as default};
