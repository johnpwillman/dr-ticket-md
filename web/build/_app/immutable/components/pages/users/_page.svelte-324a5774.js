import{S as te,i as se,s as ae,P as le,k as d,l as p,m as _,h as o,n as i,b as z,Q as ne,N as Y,q as R,r as C,I as l,a as j,c as N,V as x,O as X,T as re,W as ce,u as oe,X as ie}from"../../../chunks/singletons-9bb52d09.js";import{g as G}from"../../../chunks/navigation-4e439b8c.js";import{a as S,P as ue}from"../../../chunks/public-9d42eb47.js";function $(n,e,t){const a=n.slice();return a[10]=e[t],a[11]=e,a[12]=t,a}function he(n){let e,t=n[13]+"",a;return{c(){e=d("p"),a=R(t)},l(c){e=p(c,"P",{});var u=_(e);a=C(u,t),u.forEach(o)},m(c,u){z(c,e,u),l(e,a)},p:Y,d(c){c&&o(e)}}}function de(n){let e,t,a,c,u,b,m,v,g,D,U,T,r,k,I,y,A,V,H,q,O,J,W,B=n[1],h=[];for(let s=0;s<B.length;s+=1)h[s]=ee($(n,B,s));return{c(){e=d("div"),t=d("h3"),a=R("Registered Users"),c=j(),u=d("input"),b=j(),m=d("table"),v=d("thead"),g=d("tr"),D=d("th"),U=R("Email"),T=j(),r=d("th"),k=R("Admin"),I=j(),y=d("th"),A=R("Disabled"),V=j(),H=d("th"),q=j(),O=d("tbody");for(let s=0;s<h.length;s+=1)h[s].c();this.h()},l(s){e=p(s,"DIV",{class:!0});var E=_(e);t=p(E,"H3",{class:!0});var f=_(t);a=C(f,"Registered Users"),f.forEach(o),c=N(E),u=p(E,"INPUT",{class:!0,placeholder:!0}),E.forEach(o),b=N(s),m=p(s,"TABLE",{class:!0});var P=_(m);v=p(P,"THEAD",{});var L=_(v);g=p(L,"TR",{});var w=_(g);D=p(w,"TH",{class:!0});var M=_(D);U=C(M,"Email"),M.forEach(o),T=N(w),r=p(w,"TH",{class:!0});var Q=_(r);k=C(Q,"Admin"),Q.forEach(o),I=N(w),y=p(w,"TH",{class:!0});var K=_(y);A=C(K,"Disabled"),K.forEach(o),V=N(w),H=p(w,"TH",{class:!0}),_(H).forEach(o),w.forEach(o),L.forEach(o),q=N(P),O=p(P,"TBODY",{});var Z=_(O);for(let F=0;F<h.length;F+=1)h[F].l(Z);Z.forEach(o),P.forEach(o),this.h()},h(){i(t,"class","text-center"),i(u,"class","form-control"),i(u,"placeholder","Search by email"),i(e,"class","mx-auto col-md-3 pb-4"),i(D,"class","svelte-1pup5v5"),i(r,"class","svelte-1pup5v5"),i(y,"class","svelte-1pup5v5"),i(H,"class","svelte-1pup5v5"),i(m,"class","mx-auto user-table svelte-1pup5v5")},m(s,E){z(s,e,E),l(e,t),l(t,a),l(e,c),l(e,u),x(u,n[0]),z(s,b,E),z(s,m,E),l(m,v),l(v,g),l(g,D),l(D,U),l(g,T),l(g,r),l(r,k),l(g,I),l(g,y),l(y,A),l(g,V),l(g,H),l(m,q),l(m,O);for(let f=0;f<h.length;f+=1)h[f].m(O,null);J||(W=X(u,"input",n[5]),J=!0)},p(s,E){if(E&1&&u.value!==s[0]&&x(u,s[0]),E&10){B=s[1];let f;for(f=0;f<B.length;f+=1){const P=$(s,B,f);h[f]?h[f].p(P,E):(h[f]=ee(P),h[f].c(),h[f].m(O,null))}for(;f<h.length;f+=1)h[f].d(1);h.length=B.length}},d(s){s&&o(e),s&&o(b),s&&o(m),re(h,s),J=!1,W()}}}function ee(n){let e,t,a=n[10].email+"",c,u,b,m,v,g,D,U,T,r,k,I,y,A,V,H,q,O;function J(){n[6].call(v,n[11],n[12])}function W(){n[7].call(r,n[11],n[12])}function B(){return n[8](n[10])}return{c(){e=d("tr"),t=d("td"),c=R(a),u=j(),b=d("td"),m=d("div"),v=d("input"),g=R(`\r
                        Admin`),D=j(),U=d("td"),T=d("div"),r=d("input"),k=R(`\r
                        Disabled`),I=j(),y=d("td"),A=d("button"),V=R("Update"),H=j(),this.h()},l(h){e=p(h,"TR",{});var s=_(e);t=p(s,"TD",{class:!0});var E=_(t);c=C(E,a),E.forEach(o),u=N(s),b=p(s,"TD",{class:!0});var f=_(b);m=p(f,"DIV",{class:!0});var P=_(m);v=p(P,"INPUT",{class:!0,type:!0,name:!0}),g=C(P,`\r
                        Admin`),P.forEach(o),f.forEach(o),D=N(s),U=p(s,"TD",{class:!0});var L=_(U);T=p(L,"DIV",{class:!0});var w=_(T);r=p(w,"INPUT",{class:!0,type:!0,name:!0}),k=C(w,`\r
                        Disabled`),w.forEach(o),L.forEach(o),I=N(s),y=p(s,"TD",{class:!0});var M=_(y);A=p(M,"BUTTON",{class:!0,type:!0,name:!0});var Q=_(A);V=C(Q,"Update"),Q.forEach(o),M.forEach(o),H=N(s),s.forEach(o),this.h()},h(){i(t,"class","svelte-1pup5v5"),i(v,"class","form-check-input"),i(v,"type","checkbox"),i(v,"name","admin"),i(m,"class","form-check"),i(b,"class","text-center svelte-1pup5v5"),i(r,"class","form-check-input"),i(r,"type","checkbox"),i(r,"name","disabled"),i(T,"class","form-check"),i(U,"class","text-center svelte-1pup5v5"),i(A,"class","btn btn-secondary btn-sm bg-indigo-400 svelte-1pup5v5"),i(A,"type","submit"),i(A,"name","submit"),i(y,"class","text-center svelte-1pup5v5")},m(h,s){z(h,e,s),l(e,t),l(t,c),l(e,u),l(e,b),l(b,m),l(m,v),v.checked=n[10].admin,l(m,g),l(e,D),l(e,U),l(U,T),l(T,r),r.checked=n[10].disabled,l(T,k),l(e,I),l(e,y),l(y,A),l(A,V),l(e,H),q||(O=[X(v,"change",J),X(r,"change",W),X(A,"click",ce(B))],q=!0)},p(h,s){n=h,s&2&&a!==(a=n[10].email+"")&&oe(c,a),s&2&&(v.checked=n[10].admin),s&2&&(r.checked=n[10].disabled)},d(h){h&&o(e),q=!1,ie(O)}}}function pe(n){let e,t;return{c(){e=d("p"),t=R("Retrieving users")},l(a){e=p(a,"P",{});var c=_(e);t=C(c,"Retrieving users"),c.forEach(o)},m(a,c){z(a,e,c),l(e,t)},p:Y,d(a){a&&o(e)}}}function fe(n){let e,t={ctx:n,current:null,token:null,hasCatch:!0,pending:pe,then:de,catch:he,error:13};return le(n[2](),t),{c(){e=d("main"),t.block.c(),this.h()},l(a){e=p(a,"MAIN",{class:!0});var c=_(e);t.block.l(c),c.forEach(o),this.h()},h(){i(e,"class","container svelte-1pup5v5")},m(a,c){z(a,e,c),t.block.m(e,t.anchor=null),t.mount=()=>e,t.anchor=null},p(a,[c]){n=a,ne(t,n,c)},i:Y,o:Y,d(a){a&&o(e),t.block.d(),t.token=null,t=null}}}function _e(n,e,t){let a,c=ue,u=[],b="";async function m(){let r=S.get("user"),k=r?JSON.parse(r):void 0;if((!k||!k.admin)&&await G("/login"),S.get("jwt")){const I=await fetch(c+"users/",{headers:{Authorization:"Bearer "+S.get("jwt"),"Content-Type":"application/json"}});I.status===401&&(S.remove("jwt"),S.remove("user"),await G("/login",{invalidateAll:!0})),t(4,u=await I.json())}}async function v(r){confirm("Update user?")==!0&&(await fetch(c+"users/"+r.key,{method:"PATCH",body:JSON.stringify(r),headers:{Authorization:"Bearer "+S.get("jwt"),"Content-Type":"application/json"}})).status===401&&(S.remove("jwt"),S.remove("user"),await G("/login",{invalidateAll:!0}))}function g(){b=this.value,t(0,b)}function D(r,k){r[k].admin=this.checked,t(1,a),t(4,u),t(0,b)}function U(r,k){r[k].disabled=this.checked,t(1,a),t(4,u),t(0,b)}const T=r=>v(r);return n.$$.update=()=>{n.$$.dirty&17&&t(1,a=u.filter(r=>r.email.includes(b)))},[b,a,m,v,u,g,D,U,T]}class ge extends te{constructor(e){super(),se(this,e,_e,fe,ae,{})}}export{ge as default};
