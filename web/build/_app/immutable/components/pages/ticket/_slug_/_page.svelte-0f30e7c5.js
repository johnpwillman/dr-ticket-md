import{S as ye,i as we,s as Ie,P as ue,k as c,a as y,q as w,l as i,m as u,c as I,r as D,h as o,n as d,b as B,I as s,Q as De,u as ee,N as F,p as Xe,R as be,f as ie,t as de,o as xe,Y as et,w as Fe,x as Qe,Z as tt,V as Ae,_ as Ne,y as Ye,O as Ee,W as lt,g as at,d as rt,T as st,z as Ze,X as nt}from"../../../../chunks/singletons-ba63ed95.js";import{g as Ue,P as ot}from"../../../../chunks/public-f5c80973.js";import{a as oe}from"../../../../chunks/js.cookie-6fa27514.js";function ct(r){let t,l=r[3].message+"",e;return{c(){t=c("p"),e=w(l),this.h()},l(a){t=i(a,"P",{style:!0});var n=u(t);e=D(n,l),n.forEach(o),this.h()},h(){Xe(t,"color","red")},m(a,n){B(a,t,n),s(t,e)},p(a,n){n&1&&l!==(l=a[3].message+"")&&ee(e,l)},d(a){a&&o(t)}}}function it(r){let t,l;return{c(){t=c("img"),this.h()},l(e){t=i(e,"IMG",{class:!0,width:!0,height:!0,src:!0,alt:!0}),this.h()},h(){d(t,"class","bd-placeholder-img flex-shrink-0 me-2 rounded"),d(t,"width","48"),d(t,"height","48"),be(t.src,l=r[2])||d(t,"src",l),d(t,"alt","gravatar-img")},m(e,a){B(e,t,a)},p(e,a){a&1&&!be(t.src,l=e[2])&&d(t,"src",l)},d(e){e&&o(t)}}}function dt(r){let t,l;return{c(){t=c("p"),l=w("...")},l(e){t=i(e,"P",{});var a=u(t);l=D(a,"..."),a.forEach(o)},m(e,a){B(e,t,a),s(t,l)},p:F,d(e){e&&o(t)}}}function ut(r){let t,l=r[0].body+"",e;return{c(){t=c("p"),e=w(l)},l(a){t=i(a,"P",{});var n=u(t);e=D(n,l),n.forEach(o)},m(a,n){B(a,t,n),s(t,e)},p(a,n){n&1&&l!==(l=a[0].body+"")&&ee(e,l)},d(a){a&&o(t)}}}function mt(r){let t,l=r[1].render(r[0].body)+"";return{c(){t=c("p")},l(e){t=i(e,"P",{});var a=u(t);a.forEach(o)},m(e,a){B(e,t,a),t.innerHTML=l},p(e,a){a&3&&l!==(l=e[1].render(e[0].body)+"")&&(t.innerHTML=l)},d(e){e&&o(t)}}}function ft(r){let t,l,e,a,n,E,R,b=r[0].submitted_by+"",T,N,M,f,Z,Q=new Date(r[0].created_at).toISOString().match(/(\d|-|:)+/g)[0]+"",U,$,K,te,Y=new Date(r[0].created_at).toISOString().match(/(\d|-|:)+/g)[1]+"",q,J,S,_,H,G,W,A=r[0].status.toUpperCase()+"",g,j={ctx:r,current:null,token:null,hasCatch:!0,pending:dt,then:it,catch:ct,value:2,error:3};ue(a=$e(r[0].submitted_by,48),j);function le(k,V){return k[1]?mt:ut}let O=le(r),v=O(r);return{c(){t=c("div"),l=c("div"),e=c("div"),j.block.c(),n=y(),E=c("br"),R=y(),T=w(b),N=y(),M=c("br"),f=c("br"),Z=y(),U=w(Q),$=y(),K=c("br"),te=y(),q=w(Y),J=y(),S=c("div"),_=c("div"),v.c(),H=y(),G=c("div"),W=w("Ticket state set to: "),g=w(A),this.h()},l(k){t=i(k,"DIV",{class:!0});var V=u(t);l=i(V,"DIV",{class:!0});var p=u(l);e=i(p,"DIV",{class:!0});var h=u(e);j.block.l(h),n=I(h),E=i(h,"BR",{}),R=I(h),T=D(h,b),N=I(h),M=i(h,"BR",{}),f=i(h,"BR",{}),Z=I(h),U=D(h,Q),$=I(h),K=i(h,"BR",{}),te=I(h),q=D(h,Y),h.forEach(o),J=I(p),S=i(p,"DIV",{class:!0});var x=u(S);_=i(x,"DIV",{class:!0});var z=u(_);v.l(z),z.forEach(o),H=I(x),G=i(x,"DIV",{class:!0});var se=u(G);W=D(se,"Ticket state set to: "),g=D(se,A),se.forEach(o),x.forEach(o),p.forEach(o),V.forEach(o),this.h()},h(){d(e,"class","col-md-3 pt-2 pb-2 text-center comment-info svelte-rvquzj"),d(_,"class","card-body w-100"),d(G,"class","card-footer w-100 text-muted"),d(S,"class","col-md-9 d-flex align-items-start flex-column"),d(l,"class","row g-0"),d(t,"class","card mb-3")},m(k,V){B(k,t,V),s(t,l),s(l,e),j.block.m(e,j.anchor=null),j.mount=()=>e,j.anchor=n,s(e,n),s(e,E),s(e,R),s(e,T),s(e,N),s(e,M),s(e,f),s(e,Z),s(e,U),s(e,$),s(e,K),s(e,te),s(e,q),s(l,J),s(l,S),s(S,_),v.m(_,null),s(S,H),s(S,G),s(G,W),s(G,g)},p(k,[V]){r=k,j.ctx=r,V&1&&a!==(a=$e(r[0].submitted_by,48))&&ue(a,j)||De(j,r,V),V&1&&b!==(b=r[0].submitted_by+"")&&ee(T,b),V&1&&Q!==(Q=new Date(r[0].created_at).toISOString().match(/(\d|-|:)+/g)[0]+"")&&ee(U,Q),V&1&&Y!==(Y=new Date(r[0].created_at).toISOString().match(/(\d|-|:)+/g)[1]+"")&&ee(q,Y),O===(O=le(r))&&v?v.p(r,V):(v.d(1),v=O(r),v&&(v.c(),v.m(_,null))),V&1&&A!==(A=r[0].status.toUpperCase()+"")&&ee(g,A)},i:F,o:F,d(k){k&&o(t),j.block.d(),j.token=null,j=null,v.d()}}}async function ht(r){return(await(await fetch("https://api.hashify.net/hash/md5/hex",{method:"POST",body:r})).json()).Digest}async function $e(r,t,l,e,a){return r=typeof r<"u"?r:"john.doe@example.com",t=t>=1&&t<=2048?t:80,l=typeof l<"u"?l:"mm",e=typeof e<"u"?e:"g",a=a===!0?"y":"n","https://secure.gravatar.com/avatar/"+await ht(r.toLowerCase().trim())+"?size="+t+"&default="+encodeURIComponent(l)+"&rating="+e+(a==="y"?"&forcedefault="+a:"")}function _t(r,t,l){let{comment:e}=t,{md:a}=t;return r.$$set=n=>{"comment"in n&&l(0,e=n.comment),"md"in n&&l(1,a=n.md)},[e,a]}class vt extends ye{constructor(t){super(),we(this,t,_t,ft,Ie,{comment:0,md:1})}}function pt(r){let t,l=r[3].message+"",e;return{c(){t=c("p"),e=w(l),this.h()},l(a){t=i(a,"P",{style:!0});var n=u(t);e=D(n,l),n.forEach(o),this.h()},h(){Xe(t,"color","red")},m(a,n){B(a,t,n),s(t,e)},p(a,n){n&1&&l!==(l=a[3].message+"")&&ee(e,l)},d(a){a&&o(t)}}}function bt(r){let t,l;return{c(){t=c("img"),this.h()},l(e){t=i(e,"IMG",{class:!0,width:!0,height:!0,src:!0,alt:!0}),this.h()},h(){d(t,"class","bd-placeholder-img flex-shrink-0 me-2 rounded"),d(t,"width","48"),d(t,"height","48"),be(t.src,l=r[2])||d(t,"src",l),d(t,"alt","gravatar-img")},m(e,a){B(e,t,a)},p(e,a){a&1&&!be(t.src,l=e[2])&&d(t,"src",l)},d(e){e&&o(t)}}}function gt(r){let t,l;return{c(){t=c("p"),l=w("...")},l(e){t=i(e,"P",{});var a=u(t);l=D(a,"..."),a.forEach(o)},m(e,a){B(e,t,a),s(t,l)},p:F,d(e){e&&o(t)}}}function kt(r){let t,l=r[0].body+"",e;return{c(){t=c("p"),e=w(l)},l(a){t=i(a,"P",{});var n=u(t);e=D(n,l),n.forEach(o)},m(a,n){B(a,t,n),s(t,e)},p(a,n){n&1&&l!==(l=a[0].body+"")&&ee(e,l)},d(a){a&&o(t)}}}function Et(r){let t,l=r[1].render(r[0].body)+"";return{c(){t=c("p")},l(e){t=i(e,"P",{});var a=u(t);a.forEach(o)},m(e,a){B(e,t,a),t.innerHTML=l},p(e,a){a&3&&l!==(l=e[1].render(e[0].body)+"")&&(t.innerHTML=l)},d(e){e&&o(t)}}}function yt(r){let t,l,e,a,n,E,R,b=r[0].submitted_by+"",T,N,M,f,Z,Q=new Date(r[0].created_at).toISOString().match(/(\d|-|:)+/g)[0]+"",U,$,K,te,Y=new Date(r[0].created_at).toISOString().match(/(\d|-|:)+/g)[1]+"",q,J,S,_,H=r[0].subject+"",G,W,A,g={ctx:r,current:null,token:null,hasCatch:!0,pending:gt,then:bt,catch:pt,value:2,error:3};ue(a=qe(r[0].submitted_by,48),g);function j(v,k){return v[1]?Et:kt}let le=j(r),O=le(r);return{c(){t=c("div"),l=c("div"),e=c("div"),g.block.c(),n=y(),E=c("br"),R=y(),T=w(b),N=y(),M=c("br"),f=c("br"),Z=y(),U=w(Q),$=y(),K=c("br"),te=y(),q=w(Y),J=y(),S=c("div"),_=c("h5"),G=w(H),W=y(),A=c("div"),O.c(),this.h()},l(v){t=i(v,"DIV",{class:!0});var k=u(t);l=i(k,"DIV",{class:!0});var V=u(l);e=i(V,"DIV",{class:!0});var p=u(e);g.block.l(p),n=I(p),E=i(p,"BR",{}),R=I(p),T=D(p,b),N=I(p),M=i(p,"BR",{}),f=i(p,"BR",{}),Z=I(p),U=D(p,Q),$=I(p),K=i(p,"BR",{}),te=I(p),q=D(p,Y),p.forEach(o),J=I(V),S=i(V,"DIV",{class:!0});var h=u(S);_=i(h,"H5",{class:!0});var x=u(_);G=D(x,H),x.forEach(o),W=I(h),A=i(h,"DIV",{class:!0});var z=u(A);O.l(z),z.forEach(o),h.forEach(o),V.forEach(o),k.forEach(o),this.h()},h(){d(e,"class","col-md-3 pt-2 pb-2 text-center comment-info svelte-rvquzj"),d(_,"class","card-header"),d(A,"class","card-body"),d(S,"class","col-md-9"),d(l,"class","row g-0"),d(t,"class","card mb-3")},m(v,k){B(v,t,k),s(t,l),s(l,e),g.block.m(e,g.anchor=null),g.mount=()=>e,g.anchor=n,s(e,n),s(e,E),s(e,R),s(e,T),s(e,N),s(e,M),s(e,f),s(e,Z),s(e,U),s(e,$),s(e,K),s(e,te),s(e,q),s(l,J),s(l,S),s(S,_),s(_,G),s(S,W),s(S,A),O.m(A,null)},p(v,[k]){r=v,g.ctx=r,k&1&&a!==(a=qe(r[0].submitted_by,48))&&ue(a,g)||De(g,r,k),k&1&&b!==(b=r[0].submitted_by+"")&&ee(T,b),k&1&&Q!==(Q=new Date(r[0].created_at).toISOString().match(/(\d|-|:)+/g)[0]+"")&&ee(U,Q),k&1&&Y!==(Y=new Date(r[0].created_at).toISOString().match(/(\d|-|:)+/g)[1]+"")&&ee(q,Y),k&1&&H!==(H=r[0].subject+"")&&ee(G,H),le===(le=j(r))&&O?O.p(r,k):(O.d(1),O=le(r),O&&(O.c(),O.m(A,null)))},i:F,o:F,d(v){v&&o(t),g.block.d(),g.token=null,g=null,O.d()}}}async function wt(r){return(await(await fetch("https://api.hashify.net/hash/md5/hex",{method:"POST",body:r})).json()).Digest}async function qe(r,t,l,e,a){return r=typeof r<"u"?r:"john.doe@example.com",t=t>=1&&t<=2048?t:80,l=typeof l<"u"?l:"mm",e=typeof e<"u"?e:"g",a=a===!0?"y":"n","https://secure.gravatar.com/avatar/"+await wt(r.toLowerCase().trim())+"?size="+t+"&default="+encodeURIComponent(l)+"&rating="+e+(a==="y"?"&forcedefault="+a:"")}function It(r,t,l){let{ticket:e}=t,{md:a}=t;return r.$$set=n=>{"ticket"in n&&l(0,e=n.ticket),"md"in n&&l(1,a=n.md)},[e,a]}class Dt extends ye{constructor(t){super(),we(this,t,It,yt,Ie,{ticket:0,md:1})}}function Je(r,t,l){const e=r.slice();return e[10]=t[l],e}function Tt(r){return{c:F,l:F,m:F,p:F,i:F,o:F,d:F}}function St(r){let t,l,e,a,n,E,R=r[9].subject+"",b,T,N,M,f,Z,Q,U,$,K,te,Y,q,J,S,_,H,G,W,A,g,j,le,O,v,k,V,p,h,x,z,se,ce,me,ge,Te,X=r[0]&&Ge(r),ne=r[9].comments,P=[];for(let m=0;m<ne.length;m+=1)P[m]=We(Je(r,ne,m));const Ke=m=>de(P[m],1,1,()=>{P[m]=null});return z=new Dt({props:{ticket:r[9],md:r[0]}}),{c(){t=c("form"),l=c("div"),e=c("div"),a=c("div"),n=c("h4"),E=w('Ticket: "'),b=w(R),T=w('"'),N=y(),M=c("div"),f=c("textarea"),Z=y(),X&&X.c(),Q=y(),U=c("div"),$=c("div"),K=c("h4"),te=w("Update"),Y=y(),q=c("div"),J=c("div"),S=c("div"),_=c("select"),H=c("option"),G=w("Open"),W=c("option"),A=w("With Customer"),g=c("option"),j=w("Closed"),le=y(),O=c("div"),v=c("button"),k=w("Submit"),V=y(),p=c("div"),h=c("div");for(let m=0;m<P.length;m+=1)P[m].c();x=y(),Fe(z.$$.fragment),se=y(),ce=c("div"),this.h()},l(m){t=i(m,"FORM",{});var C=u(t);l=i(C,"DIV",{class:!0});var ae=u(l);e=i(ae,"DIV",{class:!0});var L=u(e);a=i(L,"DIV",{class:!0});var re=u(a);n=i(re,"H4",{class:!0});var fe=u(n);E=D(fe,'Ticket: "'),b=D(fe,R),T=D(fe,'"'),fe.forEach(o),N=I(re),M=i(re,"DIV",{class:!0});var Se=u(M);f=i(Se,"TEXTAREA",{class:!0,name:!0,rows:!0,placeholder:!0}),u(f).forEach(o),Se.forEach(o),Z=I(re),X&&X.l(re),re.forEach(o),L.forEach(o),Q=I(ae),U=i(ae,"DIV",{class:!0});var Oe=u(U);$=i(Oe,"DIV",{class:!0});var he=u($);K=i(he,"H4",{class:!0});var Ve=u(K);te=D(Ve,"Update"),Ve.forEach(o),Y=I(he),q=i(he,"DIV",{class:!0});var Pe=u(q);J=i(Pe,"DIV",{class:!0});var _e=u(J);S=i(_e,"DIV",{class:!0});var Ce=u(S);_=i(Ce,"SELECT",{class:!0,name:!0,id:!0});var ve=u(_);H=i(ve,"OPTION",{});var Re=u(H);G=D(Re,"Open"),Re.forEach(o),W=i(ve,"OPTION",{});var je=u(W);A=D(je,"With Customer"),je.forEach(o),g=i(ve,"OPTION",{});var Be=u(g);j=D(Be,"Closed"),Be.forEach(o),ve.forEach(o),Ce.forEach(o),le=I(_e),O=i(_e,"DIV",{class:!0});var Me=u(O);v=i(Me,"BUTTON",{class:!0});var He=u(v);k=D(He,"Submit"),He.forEach(o),Me.forEach(o),_e.forEach(o),Pe.forEach(o),he.forEach(o),Oe.forEach(o),ae.forEach(o),C.forEach(o),V=I(m),p=i(m,"DIV",{class:!0});var Le=u(p);h=i(Le,"DIV",{class:!0});var pe=u(h);for(let ke=0;ke<P.length;ke+=1)P[ke].l(pe);x=I(pe),Qe(z.$$.fragment,pe),pe.forEach(o),Le.forEach(o),se=I(m),ce=i(m,"DIV",{class:!0});var ze=u(ce);ze.forEach(o),this.h()},h(){d(n,"class","card-header"),d(f,"class","form-control"),d(f,"name","body"),d(f,"rows","5"),d(f,"placeholder","Add a comment to this ticket."),d(M,"class","card-body"),d(a,"class","card"),d(e,"class","col-md-8 comment-textarea"),d(K,"class","card-header"),H.__value="open",H.value=H.__value,W.__value="pending",W.value=W.__value,g.__value="closed",g.value=g.__value,d(_,"class","form-select comment-submit-select"),d(_,"name","status"),d(_,"id","exampleSelect"),r[2]===void 0&&tt(()=>r[7].call(_)),d(S,"class","col-md-8"),d(v,"class","btn btn-secondary bg-indigo-400 svelte-grsov"),d(O,"class","col-md-4"),d(J,"class","row"),d(q,"class","card-body"),d($,"class","card"),d(U,"class","col-md-4 comment-submit"),d(l,"class","row mb-4 comment-form"),d(h,"class","col-md-8 ticket-comments"),d(p,"class","row"),d(ce,"class","col-md-4 ticket-info")},m(m,C){B(m,t,C),s(t,l),s(l,e),s(e,a),s(a,n),s(n,E),s(n,b),s(n,T),s(a,N),s(a,M),s(M,f),Ae(f,r[1]),s(a,Z),X&&X.m(a,null),s(l,Q),s(l,U),s(U,$),s($,K),s(K,te),s($,Y),s($,q),s(q,J),s(J,S),s(S,_),s(_,H),s(H,G),s(_,W),s(W,A),s(_,g),s(g,j),Ne(_,r[2]),s(J,le),s(J,O),s(O,v),s(v,k),B(m,V,C),B(m,p,C),s(p,h);for(let ae=0;ae<P.length;ae+=1)P[ae].m(h,null);s(h,x),Ye(z,h,null),B(m,se,C),B(m,ce,C),me=!0,ge||(Te=[Ee(f,"input",r[6]),Ee(_,"change",r[7]),Ee(t,"submit",lt(r[4]))],ge=!0)},p(m,C){if(C&2&&Ae(f,m[1]),m[0]?X?X.p(m,C):(X=Ge(m),X.c(),X.m(a,null)):X&&(X.d(1),X=null),C&4&&Ne(_,m[2]),C&9){ne=m[9].comments;let L;for(L=0;L<ne.length;L+=1){const re=Je(m,ne,L);P[L]?(P[L].p(re,C),ie(P[L],1)):(P[L]=We(re),P[L].c(),ie(P[L],1),P[L].m(h,x))}for(at(),L=ne.length;L<P.length;L+=1)Ke(L);rt()}const ae={};C&1&&(ae.md=m[0]),z.$set(ae)},i(m){if(!me){for(let C=0;C<ne.length;C+=1)ie(P[C]);ie(z.$$.fragment,m),me=!0}},o(m){P=P.filter(Boolean);for(let C=0;C<P.length;C+=1)de(P[C]);de(z.$$.fragment,m),me=!1},d(m){m&&o(t),X&&X.d(),m&&o(V),m&&o(p),st(P,m),Ze(z),m&&o(se),m&&o(ce),ge=!1,nt(Te)}}}function Ge(r){let t,l,e,a,n,E,R=r[0].render(r[1])+"";return{c(){t=c("div"),l=c("p"),e=c("strong"),a=w("Preview:"),n=y(),E=c("p"),this.h()},l(b){t=i(b,"DIV",{class:!0});var T=u(t);l=i(T,"P",{});var N=u(l);e=i(N,"STRONG",{});var M=u(e);a=D(M,"Preview:"),M.forEach(o),N.forEach(o),n=I(T),E=i(T,"P",{});var f=u(E);f.forEach(o),T.forEach(o),this.h()},h(){d(t,"class","card-footer")},m(b,T){B(b,t,T),s(t,l),s(l,e),s(e,a),s(t,n),s(t,E),E.innerHTML=R},p(b,T){T&3&&R!==(R=b[0].render(b[1])+"")&&(E.innerHTML=R)},d(b){b&&o(t)}}}function We(r){let t,l;return t=new vt({props:{comment:r[10],md:r[0]}}),{c(){Fe(t.$$.fragment)},l(e){Qe(t.$$.fragment,e)},m(e,a){Ye(t,e,a),l=!0},p(e,a){const n={};a&1&&(n.md=e[0]),t.$set(n)},i(e){l||(ie(t.$$.fragment,e),l=!0)},o(e){de(t.$$.fragment,e),l=!1},d(e){Ze(t,e)}}}function Ot(r){let t,l;return{c(){t=c("h4"),l=w("..Retrieving ticket")},l(e){t=i(e,"H4",{});var a=u(t);l=D(a,"..Retrieving ticket"),a.forEach(o)},m(e,a){B(e,t,a),s(t,l)},p:F,i:F,o:F,d(e){e&&o(t)}}}function Vt(r){let t,l,e={ctx:r,current:null,token:null,hasCatch:!1,pending:Ot,then:St,catch:Tt,value:9,blocks:[,,,]};return ue(r[3](),e),{c(){t=c("main"),e.block.c(),this.h()},l(a){t=i(a,"MAIN",{class:!0});var n=u(t);e.block.l(n),n.forEach(o),this.h()},h(){d(t,"class","container svelte-grsov")},m(a,n){B(a,t,n),e.block.m(t,e.anchor=null),e.mount=()=>t,e.anchor=null,l=!0},p(a,[n]){r=a,De(e,r,n)},i(a){l||(ie(e.block),l=!0)},o(a){for(let n=0;n<3;n+=1){const E=e.blocks[n];de(E)}l=!1},d(a){a&&o(t),e.block.d(),e.token=null,e=null}}}function Pt(r,t,l){let{data:e}=t,a=ot,n;xe(async()=>{l(0,n=new window.remarkable.Remarkable)});let E="",R;async function b(){if(oe.get("jwt")){const f=await fetch(a+"tickets/"+e.slug,{headers:{Authorization:"Bearer "+oe.get("jwt")}});f.status===401&&(oe.remove("jwt"),oe.remove("user"),await Ue("/login",{invalidateAll:!0}));let Z=await f.json();return l(2,R=Z.status),Z}}async function T(){const f=await fetch(a+"tickets/"+ticket.key+"/comments",{method:"POST",body:JSON.stringify({body:E,status:R}),headers:{Authorization:"Bearer "+oe.get("jwt"),"Content-Type":"application/json"}});f.status===401&&(oe.remove("jwt"),oe.remove("user"),await Ue("/login",{invalidateAll:!0})),await f.text(),await b(),l(1,E="")}function N(){E=this.value,l(1,E)}function M(){R=et(this),l(2,R)}return r.$$set=f=>{"data"in f&&l(5,e=f.data)},[n,E,R,b,T,e,N,M]}class Bt extends ye{constructor(t){super(),we(this,t,Pt,Vt,Ie,{data:5})}}export{Bt as default};
