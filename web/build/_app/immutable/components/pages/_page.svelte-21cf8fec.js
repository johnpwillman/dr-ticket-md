import{S as oe,i as ie,s as ue,P as K,k as v,q as E,a as j,l as p,m as k,r as $,h as u,c as V,n as f,b as I,I as i,u as O,Q as he,N as b,p as de,R as se,f as S,t as q,e as le,g as fe,d as _e,T as me,w as ve,x as pe,y as ke,z as be}from"../../chunks/singletons-f2c6cb84.js";import{g as ge}from"../../chunks/navigation-5f0d6e36.js";import{a as A,P as ye}from"../../chunks/public-9d42eb47.js";function we(r){let e,t=r[2].message+"",s;return{c(){e=v("p"),s=E(t),this.h()},l(l){e=p(l,"P",{style:!0});var h=k(e);s=$(h,t),h.forEach(u),this.h()},h(){de(e,"color","red")},m(l,h){I(l,e,h),i(e,s)},p(l,h){h&1&&t!==(t=l[2].message+"")&&O(s,t)},d(l){l&&u(e)}}}function Ee(r){let e,t;return{c(){e=v("img"),this.h()},l(s){e=p(s,"IMG",{class:!0,width:!0,height:!0,src:!0,alt:!0}),this.h()},h(){f(e,"class","bd-placeholder-img flex-shrink-0 me-2 rounded"),f(e,"width","32"),f(e,"height","32"),se(e.src,t=r[1])||f(e,"src",t),f(e,"alt","gravatar-img")},m(s,l){I(s,e,l)},p(s,l){l&1&&!se(e.src,t=s[1])&&f(e,"src",t)},d(s){s&&u(e)}}}function $e(r){let e,t;return{c(){e=v("p"),t=E("...")},l(s){e=p(s,"P",{});var l=k(e);t=$(l,"..."),l.forEach(u)},m(s,l){I(s,e,l),i(e,t)},p:b,d(s){s&&u(e)}}}function Ie(r){let e,t,s,l,h=r[0].status+"",m,c,d,a,o,n,_,g,D,T=r[0].subject+"",B,Q,x=r[0].submitted_by+"",G,F,L,C,N=new Date(r[0].created_at*1e3).toDateString()+"",H,J,y={ctx:r,current:null,token:null,hasCatch:!0,pending:$e,then:Ee,catch:we,value:1,error:2};return K(o=ae(r[0].submitted_by,32),y),{c(){e=v("a"),t=v("div"),s=v("div"),l=v("strong"),m=E(h),c=j(),d=v("div"),a=v("div"),y.block.c(),n=j(),_=v("div"),g=v("p"),D=v("strong"),B=E(T),Q=j(),G=E(x),F=j(),L=v("div"),C=v("p"),H=E(N),this.h()},l(P){e=p(P,"A",{class:!0,href:!0});var w=k(e);t=p(w,"DIV",{class:!0});var R=k(t);s=p(R,"DIV",{class:!0});var W=k(s);l=p(W,"STRONG",{class:!0});var X=k(l);m=$(X,h),X.forEach(u),W.forEach(u),c=V(R),d=p(R,"DIV",{class:!0});var Y=k(d);a=p(Y,"DIV",{class:!0});var M=k(a);y.block.l(M),n=V(M),_=p(M,"DIV",{class:!0});var Z=k(_);g=p(Z,"P",{class:!0});var U=k(g);D=p(U,"STRONG",{class:!0});var z=k(D);B=$(z,T),z.forEach(u),Q=V(U),G=$(U,x),U.forEach(u),Z.forEach(u),M.forEach(u),Y.forEach(u),F=V(R),L=p(R,"DIV",{class:!0});var ee=k(L);C=p(ee,"P",{});var te=k(C);H=$(te,N),te.forEach(u),ee.forEach(u),R.forEach(u),w.forEach(u),this.h()},h(){f(l,"class","d-flex text-gray-dark mr-1em"),f(s,"class","col-md-1 ticket-status svelte-1wc0ha2"),f(D,"class","d-block text-gray-dark ticket-subject svelte-1wc0ha2"),f(g,"class","pb-3 mb-0 small lh-sm"),f(_,"class","d-flex justify-content-between"),f(a,"class","d-flex"),f(d,"class","col-md-8"),f(L,"class","col-md-3 text-end"),f(t,"class","d-flex text-muted pt-3 border-bottom"),f(e,"class","no-underline svelte-1wc0ha2"),f(e,"href",J="/ticket/"+r[0].key)},m(P,w){I(P,e,w),i(e,t),i(t,s),i(s,l),i(l,m),i(t,c),i(t,d),i(d,a),y.block.m(a,y.anchor=null),y.mount=()=>a,y.anchor=n,i(a,n),i(a,_),i(_,g),i(g,D),i(D,B),i(g,Q),i(g,G),i(t,F),i(t,L),i(L,C),i(C,H)},p(P,[w]){r=P,w&1&&h!==(h=r[0].status+"")&&O(m,h),y.ctx=r,w&1&&o!==(o=ae(r[0].submitted_by,32))&&K(o,y)||he(y,r,w),w&1&&T!==(T=r[0].subject+"")&&O(B,T),w&1&&x!==(x=r[0].submitted_by+"")&&O(G,x),w&1&&N!==(N=new Date(r[0].created_at*1e3).toDateString()+"")&&O(H,N),w&1&&J!==(J="/ticket/"+r[0].key)&&f(e,"href",J)},i:b,o:b,d(P){P&&u(e),y.block.d(),y.token=null,y=null}}}async function De(r){return(await(await fetch("https://api.hashify.net/hash/md5/hex",{method:"POST",body:r})).json()).Digest}async function ae(r,e,t,s,l){return r=typeof r<"u"?r:"john.doe@example.com",e=e>=1&&e<=2048?e:80,t=typeof t<"u"?t:"mm",s=typeof s<"u"?s:"g",l=l===!0?"y":"n","https://secure.gravatar.com/avatar/"+await De(r.toLowerCase().trim())+"?size="+e+"&default="+encodeURIComponent(t)+"&rating="+s+(l==="y"?"&forcedefault="+l:"")}function Te(r,e,t){let{ticket:s}=e;return r.$$set=l=>{"ticket"in l&&t(0,s=l.ticket)},[s]}class Pe extends oe{constructor(e){super(),ie(this,e,Te,Ie,ue,{ticket:0})}}function re(r,e,t){const s=r.slice();return s[5]=e[t],s}function ne(r){let e,t,s;return{c(){e=v("div"),t=v("a"),s=E("New Ticket"),this.h()},l(l){e=p(l,"DIV",{class:!0});var h=k(e);t=p(h,"A",{class:!0,href:!0});var m=k(t);s=$(m,"New Ticket"),m.forEach(u),h.forEach(u),this.h()},h(){f(t,"class","btn btn-outline-light"),f(t,"href","/ticket"),f(e,"class","ms-auto")},m(l,h){I(l,e,h),i(e,t),i(t,s)},d(l){l&&u(e)}}}function je(r){return{c:b,l:b,m:b,p:b,i:b,o:b,d:b}}function Ve(r){let e,t,s,l;const h=[Re,Le],m=[];function c(d,a){return d[4]?0:1}return e=c(r),t=m[e]=h[e](r),{c(){t.c(),s=le()},l(d){t.l(d),s=le()},m(d,a){m[e].m(d,a),I(d,s,a),l=!0},p(d,a){t.p(d,a)},i(d){l||(S(t),l=!0)},o(d){q(t),l=!1},d(d){m[e].d(d),d&&u(s)}}}function Le(r){let e,t;return{c(){e=v("h3"),t=E("Log in to see tickets")},l(s){e=p(s,"H3",{});var l=k(e);t=$(l,"Log in to see tickets"),l.forEach(u)},m(s,l){I(s,e,l),i(e,t)},p:b,i:b,o:b,d(s){s&&u(e)}}}function Re(r){let e,t,s,l,h,m=r[4],c=[];for(let a=0;a<m.length;a+=1)c[a]=ce(re(r,m,a));const d=a=>q(c[a],1,1,()=>{c[a]=null});return{c(){e=v("div"),t=v("h6"),s=E("Tickets List"),l=j();for(let a=0;a<c.length;a+=1)c[a].c();this.h()},l(a){e=p(a,"DIV",{class:!0});var o=k(e);t=p(o,"H6",{class:!0});var n=k(t);s=$(n,"Tickets List"),n.forEach(u),l=V(o);for(let _=0;_<c.length;_+=1)c[_].l(o);o.forEach(u),this.h()},h(){f(t,"class","border-bottom pb-2 mb-0"),f(e,"class","my-3 p-3 bg-body rounded shadow-sm")},m(a,o){I(a,e,o),i(e,t),i(t,s),i(e,l);for(let n=0;n<c.length;n+=1)c[n].m(e,null);h=!0},p(a,o){if(o&2){m=a[4];let n;for(n=0;n<m.length;n+=1){const _=re(a,m,n);c[n]?(c[n].p(_,o),S(c[n],1)):(c[n]=ce(_),c[n].c(),S(c[n],1),c[n].m(e,null))}for(fe(),n=m.length;n<c.length;n+=1)d(n);_e()}},i(a){if(!h){for(let o=0;o<m.length;o+=1)S(c[o]);h=!0}},o(a){c=c.filter(Boolean);for(let o=0;o<c.length;o+=1)q(c[o]);h=!1},d(a){a&&u(e),me(c,a)}}}function ce(r){let e,t;return e=new Pe({props:{ticket:r[5]}}),{c(){ve(e.$$.fragment)},l(s){pe(e.$$.fragment,s)},m(s,l){ke(e,s,l),t=!0},p:b,i(s){t||(S(e.$$.fragment,s),t=!0)},o(s){q(e.$$.fragment,s),t=!1},d(s){be(e,s)}}}function Se(r){let e,t;return{c(){e=v("p"),t=E("..Retrieving tickets")},l(s){e=p(s,"P",{});var l=k(e);t=$(l,"..Retrieving tickets"),l.forEach(u)},m(s,l){I(s,e,l),i(e,t)},p:b,i:b,o:b,d(s){s&&u(e)}}}function xe(r){let e,t,s,l,h,m,c,d,a=r[0]&&ne(),o={ctx:r,current:null,token:null,hasCatch:!1,pending:Se,then:Ve,catch:je,value:4,blocks:[,,,]};return K(r[1](),o),{c(){e=v("main"),t=v("div"),s=v("div"),l=v("h1"),h=E("Tickets"),m=j(),a&&a.c(),c=j(),o.block.c(),this.h()},l(n){e=p(n,"MAIN",{class:!0});var _=k(e);t=p(_,"DIV",{class:!0});var g=k(t);s=p(g,"DIV",{class:!0});var D=k(s);l=p(D,"H1",{class:!0});var T=k(l);h=$(T,"Tickets"),T.forEach(u),D.forEach(u),m=V(g),a&&a.l(g),g.forEach(u),c=V(_),o.block.l(_),_.forEach(u),this.h()},h(){f(l,"class","h4 mb-0 text-white lh-1"),f(s,"class","lh-1"),f(t,"class","d-flex w-100 align-items-center p-3 my-3 text-white bg-indigo-400 rounded shadow-sm svelte-1e5ernv"),f(e,"class","container svelte-1e5ernv")},m(n,_){I(n,e,_),i(e,t),i(t,s),i(s,l),i(l,h),i(t,m),a&&a.m(t,null),i(e,c),o.block.m(e,o.anchor=null),o.mount=()=>e,o.anchor=null,d=!0},p(n,[_]){r=n,r[0]?a||(a=ne(),a.c(),a.m(t,null)):a&&(a.d(1),a=null),he(o,r,_)},i(n){d||(S(o.block),d=!0)},o(n){for(let _=0;_<3;_+=1){const g=o.blocks[_];q(g)}d=!1},d(n){n&&u(e),a&&a.d(),o.block.d(),o.token=null,o=null}}}function Ce(r,e,t){let s=ye,l,h=A.get("user");l=h?JSON.parse(h):void 0;async function m(){if(A.get("jwt")){const c=await fetch(s+"tickets/",{headers:{Authorization:"Bearer "+A.get("jwt")}});return c.status===401&&(A.remove("jwt"),A.remove("user"),await ge("/login",{invalidateAll:!0})),await c.json()}}return[l,m]}class qe extends oe{constructor(e){super(),ie(this,e,Ce,xe,ue,{})}}export{qe as default};
